data:text/html;base64,PCFkb2N0eXBlIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgPGJhc2UgaHJlZj0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doLzY3LUZhY3Rvcnkvb25lc2hvdHRoaW5nQG1haW4vIj4KICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAiPgogIDx0aXRsZT5PbmVzaG90IExlZ2FjeTwvdGl0bGU+CiAgPHN0eWxlPgogICAgOnJvb3QgewogICAgICAtLWNvbG9yLWdyYXk6IGhzbCgwLCAwJSwgNTUlKTsKICAgICAgLS1jb250cm9scy1zaXplOiAxMHZoOwogICAgfQoKICAgIEBtZWRpYSAob3JpZW50YXRpb246IGxhbmRzY2FwZSkgewogICAgICA6cm9vdCB7CiAgICAgICAgLS1jb250cm9scy1zaXplOiAyMHZoOwogICAgICB9CiAgICB9CgogICAgaHRtbCB7CiAgICAgIHRvdWNoLWFjdGlvbjogbm9uZTsKICAgIH0KCiAgICBib2R5IHsKICAgICAgZm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgIlNlZ29lIFVJIiwgUm9ib3RvLCBzYW5zLXNlcmlmLCAiQXBwbGUgQ29sb3IgRW1vamkiLCAiU2Vnb2UgVUkgRW1vamkiOwogICAgICBtYXJnaW46IDA7CiAgICAgIGNvbG9yOiB3aGl0ZTsKICAgICAgYmFja2dyb3VuZDogYmxhY2s7CiAgICB9CgogICAgLnVuc2VsZWN0YWJsZSB7CiAgICAgIC13ZWJraXQtdG91Y2gtY2FsbG91dDogbm9uZTsKICAgICAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTsKICAgICAgdXNlci1zZWxlY3Q6IG5vbmU7CiAgICB9CgogICAgI3N0YXR1cyB7CiAgICAgIGZvbnQtc2l6ZTogMS41cmVtOwogICAgICBjb2xvcjogdmFyKC0tY29sb3ItZ3JheSk7CiAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIH0KCiAgICAjY29udHJvbHMgewogICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgIHRleHQtYWxpZ246IHJpZ2h0OwogICAgICB6LWluZGV4OiAxMDsKICAgIH0KCiAgICAjY29udHJvbHMgYnV0dG9uIHsKICAgICAgLXdlYmtpdC1hcHBlYXJhbmNlOiBidXR0b247CiAgICAgIGRpc3BsYXk6IGlubGluZS1mbGV4OwogICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsKICAgICAgYm9yZGVyOiAwOwogICAgICBjb2xvcjogd2hpdGU7CiAgICAgIGZvbnQtZmFtaWx5OiBpbmhlcml0OwogICAgICBmb250LXNpemU6IDFlbTsKICAgICAgbGluZS1oZWlnaHQ6IGluaGVyaXQ7CiAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgcGFkZGluZzogMC41cmVtOwogICAgfQoKICAgICNjb250cm9scyBzdmcgewogICAgICBwb2ludGVyLWV2ZW50czogbm9uZTsKICAgIH0KCiAgICAjY2FudmFzIHsKICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICB0b3A6IDUwJTsKICAgICAgbGVmdDogNTAlOwogICAgICB3aWR0aDogMTAwJTsKICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICBib3JkZXI6IDA7CiAgICAgIGltYWdlLXJlbmRlcmluZzogcGl4ZWxhdGVkOwogICAgICBpbWFnZS1yZW5kZXJpbmc6IGNyaXNwLWVkZ2VzOwogICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTsKICAgIH0KCiAgICBpbWcjY2FudmFzIHsKICAgICAgb2JqZWN0LWZpdDogY29udGFpbjsKICAgIH0KCiAgICAjZHBhZCwKICAgICNhcGFkIHsKICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICBib3R0b206IDFyZW07CiAgICB9CgogICAgI2RwYWQgewogICAgICBsZWZ0OiAxcmVtOwogICAgfQoKICAgICNhcGFkIHsKICAgICAgcmlnaHQ6IDFyZW07CiAgICB9CgogICAgI2RwYWQgc3ZnIHsKICAgICAgd2lkdGg6IGNhbGMoMiAqIHZhcigtLWNvbnRyb2xzLXNpemUpKTsKICAgICAgaGVpZ2h0OiBjYWxjKDIgKiB2YXIoLS1jb250cm9scy1zaXplKSk7CiAgICAgIGZpbGw6IHZhcigtLWNvbG9yLWdyYXkpOwogICAgfQoKICAgICNkcGFkIHN2ZyByZWN0IHsKICAgICAgb3BhY2l0eTogMC40OwogICAgfQoKICAgICNhcGFkID4gKiB7CiAgICAgIHdpZHRoOiB2YXIoLS1jb250cm9scy1zaXplKTsKICAgICAgaGVpZ2h0OiB2YXIoLS1jb250cm9scy1zaXplKTsKICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tY29sb3ItZ3JheSk7CiAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIH0KCiAgICAjYXBhZCA+IDpsYXN0LWNoaWxkIHsKICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICByaWdodDogdmFyKC0tY29udHJvbHMtc2l6ZSk7CiAgICB9CgogICAgI2RwYWQgcGF0aDpub3QoLmFjdGl2ZSksCiAgICAjYXBhZCA+ICo6bm90KC5hY3RpdmUpIHsKICAgICAgb3BhY2l0eTogMC40OwogICAgfQogIDwvc3R5bGU+CjwvaGVhZD4KPGJvZHk+CiAgPGRpdiBpZD0iY29udHJvbHMiPgogICAgPGJ1dHRvbiBpZD0iY29udHJvbHMtZnVsbHNjcmVlbiIgY2xhc3M9InVuc2VsZWN0YWJsZSI+CiAgICAgIDxzdmcgdmlld0JveD0iMCAwIDE1IDE1IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cHM6Ly9zdGF0aWMud2lraWEubm9jb29raWUubmV0L29uZXNob3QvaW1hZ2VzLzEvMWYvTmlrb19XTUUuanBnL3JldmlzaW9uL2xhdGVzdD9jYj0yMDIyMDkyNTE5MDc1MSIgd2lkdGg9IjI1IiBoZWlnaHQ9IjI1Ij48cGF0aCBkPSJNMTMuNSAxMy41SDEwbTMuNSAwVjEwbTAgMy41bC00LTRtLjUtOGgzLjVtMCAwVjVtMC0zLjVsLTQgNE01IDEuNUgxLjVtMCAwVjVtMC0zLjVsNCA0bS00IDQuNXYzLjVtMCAwSDVtLTMuNSAwbDQtNCIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiPjwvcGF0aD48L3N2Zz4KICAgIDwvYnV0dG9uPgogIDwvZGl2PgoKICA8ZGl2IGlkPSJzdGF0dXMiPjwvZGl2PgoKICA8ZGl2IGlkPSJ2aWV3cG9ydCI+CiAgICA8Y2FudmFzIGlkPSJjYW52YXMiIHRhYmluZGV4PSItMSIgY2xhc3M9InVuc2VsZWN0YWJsZSI+PC9jYW52YXM+CgogICAgPGRpdiBpZD0iZHBhZCIgY2xhc3M9InVuc2VsZWN0YWJsZSI+CiAgICAgIDxzdmcgeG1sbnM9Imh0dHBzOi8vc3RhdGljLndpa2lhLm5vY29va2llLm5ldC9vbmVzaG90L2ltYWdlcy8xLzFmL05pa29fV01FLmpwZy9yZXZpc2lvbi9sYXRlc3Q/Y2I9MjAyMjA5MjUxOTA3NTEiIHZpZXdCb3g9IjAgMCA3MiA3MiI+CiAgICAgICAgPHBhdGggaWQ9ImRwYWQtdXAiIGRhdGEta2V5PSJBcnJvd1VwIiBkPSJNNDgsNS44QzQ4LDIuNSw0NS40LDAsNDIsMEgyOS45QzI2LjYsMCwyNCwyLjQsMjQsNS44VjI0aDI0VjUuOHoiIC8+CiAgICAgICAgPHBhdGggaWQ9ImRwYWQtcmlnaHQiIGRhdGEta2V5PSJBcnJvd1JpZ2h0IiBkPSJNNjYuMiwyNEg0OHYyNGgxOC4yYzMuMywwLDUuOC0yLjcsNS44LTZWMjkuOUM3MiwyNi41LDY5LjUsMjQsNjYuMiwyNHoiIC8+CiAgICAgICAgPHBhdGggaWQ9ImRwYWQtZG93biIgZGF0YS1rZXk9IkFycm93RG93biIgZD0iTTI0LDY2LjNjMCwzLjMsMi42LDUuNyw1LjksNS43SDQyYzMuMywwLDYtMi40LDYtNS43VjQ4SDI0VjY2LjN6IiAvPgogICAgICAgIDxwYXRoIGlkPSJkcGFkLWxlZnQiIGRhdGEta2V5PSJBcnJvd0xlZnQiIGQ9Ik01LjcsMjRDMi40LDI0LDAsMjYuNSwwLDI5LjlWNDJjMCwzLjMsMi4zLDYsNS43LDZIMjRWMjRINS43eiIgLz4KICAgICAgICA8cmVjdCBpZD0iZHBhZC1jZW50ZXIiIHg9IjI0IiB5PSIyNCIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiAvPgogICAgICA8L3N2Zz4KICAgIDwvZGl2PgoKICAgIDxkaXYgaWQ9ImFwYWQiIGNsYXNzPSJ1bnNlbGVjdGFibGUiPgogICAgICA8ZGl2IGlkPSJhcGFkLWVzY2FwZSIgZGF0YS1rZXk9IkVzY2FwZSI+PC9kaXY+CiAgICAgIDxkaXYgaWQ9ImFwYWQtZW50ZXIiIGRhdGEta2V5PSJFbnRlciI+PC9kaXY+CiAgICA8L2Rpdj4KICA8L2Rpdj4KPHNjcmlwdD4gIGFsZXJ0KCJodHRwczovL2JpdC5seS80OUxkRlc4IikKICAgIGFsZXJ0KCJSZW1lbWJlciB0aGlzIGZvciBsYXRlci4iKQogICAgPC9zY3JpcHQ+CjxzY3JpcHQgYXN5bmMgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9ImluZGV4LmpzIj48L3NjcmlwdD4KCjxzY3JpcHQ+CmNvbnN0IGhhc1RvdWNoc2NyZWVuID0gd2luZG93Lm1hdGNoTWVkaWEoJyhob3Zlcjogbm9uZSksIChwb2ludGVyOiBjb2Fyc2UpJykubWF0Y2hlczsKY29uc3QgcHJldmVudE5hdGl2ZUtleXMgPSBbJ0Fycm93VXAnLCAnQXJyb3dEb3duJywgJ0Fycm93UmlnaHQnLCAnQXJyb3dMZWZ0JywgJyAnLCAnRjEyJ107CmNvbnN0IGtleXMgPSBuZXcgTWFwKCk7CmNvbnN0IGtleXNEb3duID0gbmV3IE1hcCgpOwpjb25zdCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJyk7CmxldCBlYXN5cnBnUGxheWVyOwpsZXQgbGFzdFRvdWNoZWRJZDsKCi8vIExhdW5jaCB0aGUgUGxheWVyIGFuZCBjb25maWd1cmUgaXQKd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoZXZlbnQpID0+IHsKICAgIGNyZWF0ZUVhc3lScGdQbGF5ZXIoewogICAgICBnYW1lOiB1bmRlZmluZWQsCiAgICAgIHNhdmVGczogdW5kZWZpbmVkCiAgICB9KS50aGVuKGZ1bmN0aW9uKE1vZHVsZSkgewogICAgICAvLyBNb2R1bGUgaXMgcmVhZHkKICAgICAgZWFzeXJwZ1BsYXllciA9IE1vZHVsZTsKICAgICAgZWFzeXJwZ1BsYXllci5pbml0QXBpKCk7CiAgICAgIGNhbnZhcy5mb2N1cygpOwoKICAgICAgLy8gQ3VzdG9tIGNvZGUgaGVyZQogICAgfSk7Cn0pOwoKLy8gTWFrZSBFYXN5UlBHIHBsYXllciBlbWJlZGRhYmxlCmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4gY2FudmFzLmZvY3VzKCkpOwpjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBjYW52YXMuZm9jdXMoKSk7CgovLyBIYW5kbGUgY2xpY2tpbmcgb24gdGhlIGZ1bGxzY3JlZW4gYnV0dG9uCmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjb250cm9scy1mdWxsc2NyZWVuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgY29uc3Qgdmlld3BvcnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmlld3BvcnQnKTsKICBpZiAodmlld3BvcnQucmVxdWVzdEZ1bGxzY3JlZW4pIHsKICAgIHZpZXdwb3J0LnJlcXVlc3RGdWxsc2NyZWVuKCk7CiAgfQp9KTsKCi8qKgogKiBTaW11bGF0ZSBhIGtleWJvYXJkIGV2ZW50IG9uIHRoZSBlbXNjcmlwdGVuIGNhbnZhcwogKgogKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRUeXBlIFR5cGUgb2YgdGhlIGtleWJvYXJkIGV2ZW50CiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgS2V5IHRvIHNpbXVsYXRlCiAqLwpmdW5jdGlvbiBzaW11bGF0ZUtleWJvYXJkRXZlbnQoZXZlbnRUeXBlLCBrZXkpIHsKICBjb25zdCBldmVudCA9IG5ldyBFdmVudChldmVudFR5cGUsIHsgYnViYmxlczogdHJ1ZSB9KTsKICBldmVudC5jb2RlID0ga2V5OwoKICBjYW52YXMuZGlzcGF0Y2hFdmVudChldmVudCk7Cn0KCi8qKgogKiBTaW11bGF0ZSBhIGtleWJvYXJkIGlucHV0IGZyb20gYGtleWRvd25gIHRvIGBrZXl1cGAKICoKICogQHBhcmFtIHtzdHJpbmd9IGtleSBLZXkgdG8gc2ltdWxhdGUKICovCmZ1bmN0aW9uIHNpbXVsYXRlS2V5Ym9hcmRJbnB1dChrZXkpIHsKICBzaW11bGF0ZUtleWJvYXJkRXZlbnQoJ2tleWRvd24nLCBrZXkpOwogIHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHsKICAgIHNpbXVsYXRlS2V5Ym9hcmRFdmVudCgna2V5dXAnLCBrZXkpOwogIH0sIDEwMCk7Cn0KCi8qKgogKiBCaW5kIGEgbm9kZSBieSBhIHNwZWNpZmljIGtleSB0byBzaW11bGF0ZSBvbiB0b3VjaAogKgogKiBAcGFyYW0geyp9IG5vZGUgVGhlIG5vZGUgdG8gYmluZCBhIGtleSB0bwogKiBAcGFyYW0ge3N0cmluZ30ga2V5IEtleSB0byBzaW11bGF0ZQogKi8KZnVuY3Rpb24gYmluZEtleShub2RlLCBrZXkpIHsKICBrZXlzLnNldChub2RlLmlkLCBrZXkpOwoKICBub2RlLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBldmVudCA9PiB7CiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgc2ltdWxhdGVLZXlib2FyZEV2ZW50KCdrZXlkb3duJywga2V5KTsKICAgIGtleXNEb3duLnNldChldmVudC50YXJnZXQuaWQsIG5vZGUuaWQpOwogICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKICB9KTsKCiAgbm9kZS5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIGV2ZW50ID0+IHsKICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgogICAgY29uc3QgcHJlc3NlZEtleSA9IGtleXNEb3duLmdldChldmVudC50YXJnZXQuaWQpOwogICAgaWYgKHByZXNzZWRLZXkgJiYga2V5cy5oYXMocHJlc3NlZEtleSkpIHsKICAgICAgY29uc3Qga2V5ID0ga2V5cy5nZXQocHJlc3NlZEtleSk7CiAgICAgIHNpbXVsYXRlS2V5Ym9hcmRFdmVudCgna2V5dXAnLCBrZXkpOwogICAgfQoKICAgIGtleXNEb3duLmRlbGV0ZShldmVudC50YXJnZXQuaWQpOwogICAgbm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsKCiAgICBpZiAobGFzdFRvdWNoZWRJZCkgewogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChsYXN0VG91Y2hlZElkKS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsKICAgIH0KICB9KTsKCiAgLy8gSW5zcGlyZWQgYnkgaHR0cHM6Ly9naXRodWIuY29tL3B1bHNlamV0L21reHAtd2ViL2Jsb2IvMjYyYTIyNTRiNjg0NTY3MzExYzlmMGUxMzVlZTI5ZjZlOGMzNjEzZS9leHRyYS9qcy9kcGFkLmpzCiAgbm9kZS5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBldmVudCA9PiB7CiAgICBjb25zdCB7IHRhcmdldCwgY2xpZW50WCwgY2xpZW50WSB9ID0gZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF07CiAgICBjb25zdCBvcmlnVGFyZ2V0SWQgPSBrZXlzRG93bi5nZXQodGFyZ2V0LmlkKTsKICAgIGNvbnN0IG5leHRUYXJnZXRJZCA9IGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQoY2xpZW50WCwgY2xpZW50WSkuaWQ7CiAgICBpZiAob3JpZ1RhcmdldElkID09PSBuZXh0VGFyZ2V0SWQpIHJldHVybjsKCiAgICBpZiAob3JpZ1RhcmdldElkKSB7CiAgICAgIGNvbnN0IGtleSA9IGtleXMuZ2V0KG9yaWdUYXJnZXRJZCk7CiAgICAgIHNpbXVsYXRlS2V5Ym9hcmRFdmVudCgna2V5dXAnLCBrZXkpOwogICAgICBrZXlzRG93bi5kZWxldGUodGFyZ2V0LmlkKTsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQob3JpZ1RhcmdldElkKS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsKICAgIH0KCiAgICBpZiAoa2V5cy5oYXMobmV4dFRhcmdldElkKSkgewogICAgICBjb25zdCBrZXkgPSBrZXlzLmdldChuZXh0VGFyZ2V0SWQpOwogICAgICBzaW11bGF0ZUtleWJvYXJkRXZlbnQoJ2tleWRvd24nLCBrZXkpOwogICAgICBrZXlzRG93bi5zZXQodGFyZ2V0LmlkLCBuZXh0VGFyZ2V0SWQpOwogICAgICBsYXN0VG91Y2hlZElkID0gbmV4dFRhcmdldElkOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChuZXh0VGFyZ2V0SWQpLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgfQogIH0pCn0KCi8qKiBAdHlwZSB7e1trZXk6IG51bWJlcl06IEdhbWVwYWR9fSAqLwpsZXQgZ2FtZXBhZHMgPSB7fTsKY29uc3QgaGF2ZUV2ZW50cyA9ICdvbmdhbWVwYWRjb25uZWN0ZWQnIGluIHdpbmRvdzsKCmZ1bmN0aW9uIGFkZEdhbWVwYWQoZ2FtZXBhZCkgewogIGlmIChnYW1lcGFkID09IHVuZGVmaW5lZCkgewogICAgcmV0dXJuOwogIH0KICBnYW1lcGFkc1tnYW1lcGFkLmluZGV4XSA9IGdhbWVwYWQ7CiAgdXBkYXRlVG91Y2hDb250cm9sc1Zpc2liaWxpdHkoKTsKfQoKZnVuY3Rpb24gcmVtb3ZlR2FtZXBhZChnYW1lcGFkKSB7CiAgaWYgKGdhbWVwYWQgPT0gdW5kZWZpbmVkKSB7CiAgICByZXR1cm47CiAgfQogIGRlbGV0ZSBnYW1lcGFkc1tnYW1lcGFkLmluZGV4XTsKICB1cGRhdGVUb3VjaENvbnRyb2xzVmlzaWJpbGl0eSgpOwp9CgovKiogQHJldHVybnMge0dhbWVwYWRbXX0gKi8KZnVuY3Rpb24gZ2V0R2FtZXBhZHMoKSB7CiAgdmFyIHBhZHMgPSBuYXZpZ2F0b3IuZ2V0R2FtZXBhZHMgPyBuYXZpZ2F0b3IuZ2V0R2FtZXBhZHMoKSA6IChuYXZpZ2F0b3Iud2Via2l0R2V0R2FtZXBhZHMgPyBuYXZpZ2F0b3Iud2Via2l0R2V0R2FtZXBhZHMoKSA6IFtdKTsKICByZXR1cm4gcGFkczsKfQoKZnVuY3Rpb24gc2NhbkdhbWVQYWRzKCkgewogIHZhciBwYWRzID0gZ2V0R2FtZXBhZHMoKTsKICBmb3IgKHZhciBpID0gMDsgaSA8IHBhZHMubGVuZ3RoOyBpKyspIHsKICAgIGlmIChwYWRzW2ldKSB7CiAgICAgIGlmIChwYWRzW2ldLmluZGV4IGluIGdhbWVwYWRzKSB7CiAgICAgICAgZ2FtZXBhZHNbcGFkc1tpXS5pbmRleF0gPSBwYWRzW2ldOwogICAgICB9IGVsc2UgewogICAgICAgIGFkZEdhbWVwYWQocGFkc1tpXSk7CiAgICAgIH0KICAgIH0KICB9Cn0KCmlmICghaGF2ZUV2ZW50cykgewogIHNldEludGVydmFsKHNjYW5HYW1lUGFkcywgNTAwKTsKfQoKd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2dhbWVwYWRjb25uZWN0ZWQnLCBmdW5jdGlvbihlKSB7CiAgYWRkR2FtZXBhZChlLmdhbWVwYWQpOwp9KTsKCndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdnYW1lcGFkZGlzY29ubmVjdGVkJywgZnVuY3Rpb24oZSkgewogIHJlbW92ZUdhbWVwYWQoZS5nYW1lcGFkKTsKfSkKCmZ1bmN0aW9uIHVwZGF0ZVRvdWNoQ29udHJvbHNWaXNpYmlsaXR5KCkgewogIGlmIChoYXNUb3VjaHNjcmVlbiAmJiBPYmplY3Qua2V5cyhnYW1lcGFkcykubGVuZ3RoID09PSAwKSB7CiAgICBmb3IgKGNvbnN0IGVsZW0gb2YgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI2RwYWQsICNhcGFkJykpIHsKICAgICAgZWxlbS5zdHlsZS5kaXNwbGF5ID0gJyc7CiAgICB9CiAgfSBlbHNlIHsKICAgIC8vIElmIHdlIGRvbid0IGhhdmUgYSB0b3VjaCBzY3JlZW4sIE9SIGFueSBnYW1lcGFkcyBhcmUgY29ubmVjdGVkLi4uCiAgICBmb3IgKGNvbnN0IGVsZW0gb2YgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI2RwYWQsICNhcGFkJykpIHsKICAgICAgLy8gSGlkZSB0aGUgdG91Y2ggY29udHJvbHMKICAgICAgZWxlbS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgfQogIH0KfQoKLy8gQmluZCBhbGwgZWxlbWVudHMgcHJvdmlkaW5nIGEgYGRhdGEta2V5YCBhdHRyaWJ1dGUgd2l0aCB0aGUKLy8gZ2l2ZW4ga2V5IG9uIHRvdWNoLWJhc2VkIGRldmljZXMKaWYgKGhhc1RvdWNoc2NyZWVuKSB7CiAgZm9yIChjb25zdCBidXR0b24gb2YgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEta2V5XScpKSB7CiAgICBiaW5kS2V5KGJ1dHRvbiwgYnV0dG9uLmRhdGFzZXQua2V5KTsKICB9Cn0gZWxzZSB7CiAgLy8gUHJldmVudCBzY3JvbGxpbmcgd2hlbiBwcmVzc2luZyBzcGVjaWZpYyBrZXlzCiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBldmVudCA9PiB7CiAgICBpZiAocHJldmVudE5hdGl2ZUtleXMuaW5jbHVkZXMoZXZlbnQua2V5KSkgewogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgfQogIH0pOwoKICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignY29udGV4dG1lbnUnLCBldmVudCA9PiB7CiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgLy8gc2ltdWxhdGVLZXlib2FyZElucHV0KCdFc2NhcGUnLCAyNyk7CiAgfSk7CgogIC8vIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAvLyAgIHNpbXVsYXRlS2V5Ym9hcmRJbnB1dCgnRW50ZXInLCAxMyk7CiAgLy8gfSk7Cn0KCnVwZGF0ZVRvdWNoQ29udHJvbHNWaXNpYmlsaXR5KCk7Cjwvc2NyaXB0PgoKPC9ib2R5Pgo8L2h0bWw+
