data:text/html;base64,XFw8IS0tCmZ1bGwgY3JlZGl0IHNudWJieS50b3AKaSBqdXN0IGVkaXRlZCBpdCBhIGJpdCB0byBtYWtlIGl0IGJldHRlciBmb3IgZ24tbWF0aAotLT4KCjwhRE9DVFlQRSBodG1sPgo8aHRtbCBsYW5nPSJlbi11cyI+Cgo8aGVhZD4KICAgIDxiYXNlIGhyZWY9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC93ZWItcG9ydHMvc2xpbWUtcmFuY2hlcnNAbWFpbi8iPgogICAgPG1ldGEgY2hhcnNldD0idXRmLTgiPgogICAgPHRpdGxlPlNsaW1lIFJhbmNoZXIgRGVjb21waWxlZCB2MC4yLjE8L3RpdGxlPgogICAgPGxpbmsgcmVsPSJzaG9ydGN1dCBpY29uIiBocmVmPSJUZW1wbGF0ZURhdGEvZmF2aWNvbi5pY28iPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJUZW1wbGF0ZURhdGEvc3R5bGUuY3NzIj4KICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9Imh0dHBzOi8vYWpheC5nb29nbGVhcGlzLmNvbS9hamF4L2xpYnMvanF1ZXJ5LzEuNi4wL2pxdWVyeS5taW4uanMiPjwvc2NyaXB0PgogICAgPHNjcmlwdCBzcmM9IlRlbXBsYXRlRGF0YS9Vbml0eVByb2dyZXNzLmpzIj48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJCdWlsZC9Vbml0eUxvYWRlci5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0ibW9iaWxlLWNvbnRyb2xzLmpzIj48L3NjcmlwdD4KICAgIDxsaW5rIGhyZWY9Imh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzMj9mYW1pbHk9T3BlbitTYW5zOndnaHRANDAwOzYwMCZkaXNwbGF5PXN3YXAiIHJlbD0ic3R5bGVzaGVldCI+CjwvaGVhZD4KCjxib2R5PgogICAgPGRpdiBjbGFzcz0id2ViZ2wtY29udGVudCI+CiAgICAgICAgPGRpdiBjbGFzcz0iYmciPgogICAgICAgICAgICA8aW1nIGNsYXNzPSJiZyIgc3JjPSJUZW1wbGF0ZURhdGEvbG9hZGluZ19iZy5wbmciIHN0eWxlPSJ3aWR0aDogMTAwJTsgaGVpZ2h0OiAxMDAlOyBwYWRkaW5nOiAwcHg7IG1hcmdpbjogMHB4OyBib3JkZXI6IDBweDsgcG9zaXRpb246IGFic29sdXRlOyI+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBpZD0ibG9hZGluZy10ZXh0IiBzdHlsZT0iLXdlYmtpdC10ZXh0LXN0cm9rZS13aWR0aDogMnB4OyAtd2Via2l0LXRleHQtc3Ryb2tlLWNvbG9yOiBibGFjazsgY29sb3I6IHdoaXRlOyBmb250LXNpemU6IDQ4cHg7IGZvbnQtZmFtaWx5OiBjdXJzaXZlOyB0ZXh0LWFsaWduOiBjZW50ZXI7IG1hcmdpbi10b3A6IDIwcHg7Ij5MT0FESU5HLi4uPC9kaXY+CiAgICAgICAgPGRpdiBpZD0iZ2FtZUNvbnRhaW5lciIgc3R5bGU9IndpZHRoOiA5NjBweDsgaGVpZ2h0OiA2MDBweCI+PC9kaXY+CiAgICA8L2Rpdj4KICAgIDxzY3JpcHQgc3JjPSJUZW1wbGF0ZURhdGEvcmVzcG9uc2l2ZS5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IGRlZmVyIHNyYz0iaHR0cHM6Ly9zdGF0aWMuY2xvdWRmbGFyZWluc2lnaHRzLmNvbS9iZWFjb24ubWluLmpzL3ZjZDE1Y2JlNzc3MmY0OWMzOTljNmE1YmFiZjIyYzEyNDE3MTc2ODkxNzYwMTUiIGludGVncml0eT0ic2hhNTEyLVpwc09tbFJRVjZ5OTA3VEkwZEtCSHE5TWQyOW5uYUVJUGxrZjg0cm5hRVJucTZ6dld2UFVxcjJmdDhNMWFTMjhvTjcyUGRyQ3pTalk0VTZWYUF3MUVRPT0iIGRhdGEtY2YtYmVhY29uPSd7InZlcnNpb24iOiIyMDI0LjExLjAiLCJ0b2tlbiI6ImZiYWEyMGRhZTQ5OTQyNWViYzE5MDhkMWUzMTI4MjlmIiwiciI6MSwic2VydmVyX3RpbWluZyI6eyJuYW1lIjp7ImNmQ2FjaGVTdGF0dXMiOnRydWUsImNmRWRnZSI6dHJ1ZSwiY2ZFeHRQcmkiOnRydWUsImNmTDQiOnRydWUsImNmT3JpZ2luIjp0cnVlLCJjZlNwZWVkQnJhaW4iOnRydWV9LCJsb2NhdGlvbl9zdGFydHN3aXRoIjpudWxsfX0nIGNyb3Nzb3JpZ2luPSJhbm9ueW1vdXMiPjwvc2NyaXB0Pgo8L2JvZHk+CjxzY3JpcHQ+CiAgICBjb25zdCBvZ3hociA9IHdpbmRvdy5YTUxIdHRwUmVxdWVzdDsKCiAgICBmdW5jdGlvbiB4aHJmdW5jKCkgewogICAgICAgIGNvbnN0IHhociA9IG5ldyBvZ3hocigpOwogICAgICAgIGNvbnN0IG9wZW4gPSB4aHIub3BlbjsKICAgICAgICB4aHIub3BlbiA9IGZ1bmN0aW9uKG1ldGhvZCwgdXJsLCAuLi5yZXN0KSB7CiAgICAgICAgICAgIGlmICh1cmwuaW5jbHVkZXMoInZlcnNpb24udHh0IikpIHsKICAgICAgICAgICAgICAgIHJldHVybiBvcGVuLmNhbGwodGhpcywgbWV0aG9kLCAidXBkYXRlcy92ZXJzaW9uLnR4dCIsIC4uLnJlc3QpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHVybC5pbmNsdWRlcygic2xpbWUudHh0IikpIHsKICAgICAgICAgICAgICAgIHJldHVybiBvcGVuLmNhbGwodGhpcywgbWV0aG9kLCAidXBkYXRlcy9zbGltZS50eHQiLCAuLi5yZXN0KTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gb3Blbi5jYWxsKHRoaXMsIG1ldGhvZCwgdXJsLCAuLi5yZXN0KTsKICAgICAgICB9OwogICAgICAgIHJldHVybiB4aHI7CiAgICB9CiAgICB3aW5kb3cuWE1MSHR0cFJlcXVlc3QgPSB4aHJmdW5jOwoKICAgIHZhciBsb2FkaW5nVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiNsb2FkaW5nLXRleHQiKTsKCiAgICBsZXQgbG9hZGVkQnl0ZXMgPSAwOwoKICAgIGFzeW5jIGZ1bmN0aW9uIGZldGNoV2l0aFByb2dyZXNzKHVybCkgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKTsKICAgICAgICBjb25zdCByZWFkZXIgPSByZXNwb25zZS5ib2R5LmdldFJlYWRlcigpOwogICAgICAgIGxldCBjaHVua3MgPSBbXTsKICAgICAgICBsZXQgcmVjZWl2ZWQgPSAwOwoKICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgICBjb25zdCB7CiAgICAgICAgICAgICAgICBkb25lLAogICAgICAgICAgICAgICAgdmFsdWUKICAgICAgICAgICAgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7CiAgICAgICAgICAgIGlmIChkb25lKSBicmVhazsKICAgICAgICAgICAgcmVjZWl2ZWQgKz0gdmFsdWUubGVuZ3RoOwogICAgICAgICAgICBsb2FkZWRCeXRlcyArPSB2YWx1ZS5sZW5ndGg7CiAgICAgICAgICAgIGNodW5rcy5wdXNoKHZhbHVlKTsKCiAgICAgICAgICAgIGxldCBtYkRvbmUgPSAobG9hZGVkQnl0ZXMgLyAoMTAyNCAqIDEwMjQpKS50b0ZpeGVkKDIpOwogICAgICAgICAgICBsZXQgbWJUb3RhbCA9ICc5Mi4wMSc7CiAgICAgICAgICAgIGxvYWRpbmdUZXh0LmlubmVySFRNTCA9IGBMT0FESU5HLi4uICR7bWJEb25lfSBNQiAvICR7bWJUb3RhbH0gTUJgOwogICAgICAgIH0KCiAgICAgICAgbGV0IGZ1bGxCdWZmZXIgPSBuZXcgVWludDhBcnJheShyZWNlaXZlZCk7CiAgICAgICAgbGV0IG9mZnNldCA9IDA7CiAgICAgICAgZm9yIChsZXQgY2h1bmsgb2YgY2h1bmtzKSB7CiAgICAgICAgICAgIGZ1bGxCdWZmZXIuc2V0KGNodW5rLCBvZmZzZXQpOwogICAgICAgICAgICBvZmZzZXQgKz0gY2h1bmsubGVuZ3RoOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZnVsbEJ1ZmZlci5idWZmZXI7CiAgICB9CgogICAgYXN5bmMgZnVuY3Rpb24gbWVyZ2VGaWxlcyhmaWxlUGFydHMpIHsKICAgICAgICBjb25zdCBidWZmZXJzID0gYXdhaXQgUHJvbWlzZS5hbGwoZmlsZVBhcnRzLm1hcChwYXJ0ID0+IGZldGNoV2l0aFByb2dyZXNzKHBhcnQpKSk7CiAgICAgICAgY29uc3QgbWVyZ2VkQmxvYiA9IG5ldyBCbG9iKGJ1ZmZlcnMpOwogICAgICAgIHJldHVybiBVUkwuY3JlYXRlT2JqZWN0VVJMKG1lcmdlZEJsb2IpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFBhcnRzKGZpbGUsIHN0YXJ0LCBlbmQpIHsKICAgICAgICBsZXQgcGFydHMgPSBbXTsKICAgICAgICBmb3IgKGxldCBpID0gc3RhcnQ7IGkgPD0gZW5kOyBpKyspIHsKICAgICAgICAgICAgcGFydHMucHVzaChmaWxlICsgIi5wYXJ0IiArIGkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcGFydHM7CiAgICB9CgogICAgZnVuY3Rpb24gcmVzaXplVW5pdHlDb250YWluZXIoKSB7CiAgICAgICAgdmFyIGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJnYW1lQ29udGFpbmVyIik7CiAgICAgICAgdmFyIGNhbnZhcyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCJjYW52YXMiKTsKCiAgICAgICAgY29udGFpbmVyLnN0eWxlLndpZHRoID0gd2luZG93LmlubmVyV2lkdGggKyAicHgiOwogICAgICAgIGNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgKyAicHgiOwoKICAgICAgICBpZiAoY2FudmFzKSB7CiAgICAgICAgICAgIGNhbnZhcy5zdHlsZS53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoICsgInB4IjsKICAgICAgICAgICAgY2FudmFzLnN0eWxlLmhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodCArICJweCI7CiAgICAgICAgfQogICAgfQoKCiAgICAoYXN5bmMgKCkgPT4gewogICAgICAgIGNvbnN0IGFsbFBhcnRzID0gWwogICAgICAgICAgICAuLi5nZXRQYXJ0cygiQnVpbGQvc2xpbWVCVUlMRFMuZGF0YSIsIDEsIDQpLAogICAgICAgICAgICAuLi5nZXRQYXJ0cygiQnVpbGQvc2xpbWVCVUlMRFMud2FzbSIsIDEsIDIpCiAgICAgICAgXTsKCgogICAgICAgIGNvbnN0IFtkYXRhVXJsLCB3YXNtVXJsXSA9IGF3YWl0IFByb21pc2UuYWxsKFsKICAgICAgICAgICAgbWVyZ2VGaWxlcyhnZXRQYXJ0cygiQnVpbGQvc2xpbWVCVUlMRFMuZGF0YSIsIDEsIDQpKSwKICAgICAgICAgICAgbWVyZ2VGaWxlcyhnZXRQYXJ0cygiQnVpbGQvc2xpbWVCVUlMRFMud2FzbSIsIDEsIDIpKQogICAgICAgIF0pOwogICAgICAgIHdpbmRvdy5kYXRhVXJsbCA9IGRhdGFVcmw7CiAgICAgICAgd2luZG93Lndhc21VcmxsID0gd2FzbVVybDsKCiAgICAgICAgY29uc3QganNvbiA9IHsKICAgICAgICAgICAgImNvbXBhbnlOYW1lIjogIlNudWJzIiwKICAgICAgICAgICAgInByb2R1Y3ROYW1lIjogIlNsaW1lIFJhbmNoZXIgUHJvdG90eXBlIiwKICAgICAgICAgICAgImRhdGFVcmwiOiBkYXRhVXJsLAogICAgICAgICAgICAid2FzbUNvZGVVcmwiOiB3YXNtVXJsLAogICAgICAgICAgICAid2FzbUZyYW1ld29ya1VybCI6ICJzbGltZUJVSUxEUy5mcmFtZXdvcmsuanMiLAogICAgICAgICAgICAiVE9UQUxfTUVNT1JZIjogNTM2ODcwOTEyLAogICAgICAgICAgICAiZ3JhcGhpY3NBUEkiOiBbIldlYkdMIDIuMCIsICJXZWJHTCAxLjAiXSwKICAgICAgICAgICAgIndlYmdsQ29udGV4dEF0dHJpYnV0ZXMiOiB7CiAgICAgICAgICAgICAgICAicHJlc2VydmVEcmF3aW5nQnVmZmVyIjogZmFsc2UKICAgICAgICAgICAgfSwKICAgICAgICAgICAgInNwbGFzaFNjcmVlblN0eWxlIjogIkRhcmsiCiAgICAgICAgfTsKCiAgICAgICAgbGV0IGJsb2IgPSBuZXcgQmxvYihbSlNPTi5zdHJpbmdpZnkoanNvbildLCB7CiAgICAgICAgICAgIHR5cGU6ICJhcHBsaWNhdGlvbi9qc29uIgogICAgICAgIH0pOwogICAgICAgIGxldCBibG9iVXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicmVzaXplIiwgcmVzaXplVW5pdHlDb250YWluZXIpOwoKICAgICAgICBVbml0eUxvYWRlci5pbnN0YW50aWF0ZSgiZ2FtZUNvbnRhaW5lciIsIGpzb24sIHsKICAgICAgICAgICAgdXJsOiBibG9iVXJsLAogICAgICAgICAgICBNb2R1bGU6IHsKICAgICAgICAgICAgICAgIG9uUnVudGltZUluaXRpYWxpemVkOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICByZXNpemVVbml0eUNvbnRhaW5lcigpOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiNsb2FkaW5nLXRleHQiKS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgfSk7CiAgICB9KSgpOwo8L3NjcmlwdD4KCjwvaHRtbD4=
